<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>coherence monitor | CAI</title>
  <meta name="description" content="A practical metrics bundle that estimates when a model is stable, drifting, or collapsing. Plug into any inference loop and gate risky outputs with thresholds you control." />

  <!-- Favicons -->
  <link rel="icon" href="assets/favicon.png" />

  <!-- Base styles (use your existing site stylesheet if you have one) -->
  <link rel="stylesheet" href="styles.css" />

  <!-- Open Graph / Twitter -->
  <meta property="og:title" content="coherence monitor | compression-aware intelligence" />
  <meta property="og:description" content="A practical set of signals and thresholds to detect stability, drift, and collapse in AI systems." />
  <meta property="og:type" content="website" />
  <meta name="twitter:card" content="summary" />

  <!-- Structured data -->
  <script type="application/ld+json">
  {
    "@context":"https://schema.org",
    "@type":"TechArticle",
    "headline":"Coherence Monitor",
    "about":"Model stability and drift detection",
    "author":{"@type":"Person","name":"Michele Joseph"},
    "publisher":{"@type":"Organization","name":"Compression-Aware Intelligence"},
    "inLanguage":"en"
  }
  </script>

  <style>
    /* lightweight helpers that play nice with your styles.css */
    :root { --ink:#111; --bg:#fff; --muted:rgba(0,0,0,.65); --line:rgba(0,0,0,.08); }
    body { background:var(--bg); color:var(--ink); }
    .wrap { max-width: 1100px; margin: 0 auto; padding: 1.25rem; }
    .lede { font-size: 1.075rem; opacity: .95; }
    .site-header, .site-footer { border-top: 1px solid transparent; border-bottom: 1px solid var(--line); }
    .site-header .brand { display:flex; gap:.5rem; align-items:center; text-decoration:none; color:inherit; font-weight:600; }
    .nav a { text-decoration:none; color:inherit; opacity:.9; padding:.35rem .5rem; border-radius:.35rem; }
    .nav a[data-current] { outline:1px solid var(--ink); }
    .pill-nav { display:flex; flex-wrap:wrap; gap:.5rem; margin:.75rem 0 1.25rem; }
    .pill-nav a { border:1px solid var(--ink); padding:.35rem .65rem; border-radius:999px; text-decoration:none; }
    .card { border:1px solid var(--line); border-radius:.6rem; padding:1rem; margin:1rem 0; }
    .grid { display:grid; gap:1rem; }
    .grid.two { grid-template-columns: repeat(2, minmax(0,1fr)); }
    .grid.three { grid-template-columns: repeat(3, minmax(0,1fr)); }
    @media (max-width: 920px){ .grid.two, .grid.three { grid-template-columns:1fr; } }
    .table { width:100%; border-collapse:collapse; font-size:.95rem; }
    .table th, .table td { border-bottom:1px solid var(--line); padding:.55rem .45rem; text-align:left; vertical-align:top; }
    .kbd { font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace; background:rgba(0,0,0,.04); padding:.12rem .35rem; border-radius:.25rem; }
    pre code { display:block; padding:.75rem; border-radius:.5rem; background:rgba(0,0,0,.04); overflow:auto; }
    .note { background:rgba(0,0,0,.04); padding:.6rem .7rem; border-radius:.5rem; }
    .muted { color:var(--muted); }
    .small { font-size:.92rem; }
    .cta { display:flex; gap:.6rem; flex-wrap:wrap; margin-top:.6rem; }
    .button, .btn { display:inline-block; border:1px solid var(--ink); padding:.45rem .7rem; border-radius:.45rem; text-decoration:none; color:inherit; }
    .copy-btn { font:inherit; border:1px solid currentColor; background:transparent; padding:.3rem .55rem; border-radius:.4rem; cursor:pointer; }
    .ok { background:#eaffea; border-color:#9bd39b; }
    .warn { background:#fff6e5; border-color:#ffd07a; }
    .stop { background:#ffecec; border-color:#ffa3a3; }
  </style>
</head>

<body>
<header class="site-header">
  <div class="wrap" style="display:flex; justify-content:space-between; align-items:center; gap:1rem;">
    <a class="brand" href="index.html"><span>CAI</span></a>
    <nav class="nav" aria-label="primary">
      <a href="index.html">home</a>
      <a href="coherencefield.html" data-current>coherence monitor</a>
      <a href="principles.html">principles</a>
      <a href="applications.html">applications</a>
      <a href="implementations.html">implementations</a>
      <a href="about.html">about</a>
    </nav>
  </div>
</header>

<main class="wrap" id="main">
  <h1>coherence monitor</h1>
  <p class="lede">a practical set of signals that estimate when a model is stable, drifting, or collapsing. plug it into any inference loop and gate risky outputs with thresholds you control.</p>

  <nav class="pill-nav" aria-label="sections">
    <a href="#overview">overview</a>
    <a href="#signals">signals</a>
    <a href="#score">coherence score</a>
    <a href="#thresholds">default thresholds</a>
    <a href="#quickstart">quick start</a>
    <a href="#examples">examples</a>
    <a href="#validation">validation</a>
    <a href="#faq">faq</a>
  </nav>

  <!-- Overview -->
  <section class="card" id="overview">
    <h2>overview</h2>
    <p><strong>what it is</strong>: a small metrics bundle and thresholds that estimate stability under compression and perturbation.</p>
    <div class="grid two">
      <div class="card">
        <h3>what it measures</h3>
        <ul>
          <li>consistency across semantically equivalent prompts</li>
          <li>response rhythm under tiny input changes</li>
          <li>agreement across agents or temperature seeds</li>
          <li>waste heat signals like tokens per second vs gain</li>
        </ul>
      </div>
      <div class="card">
        <h3>what you get</h3>
        <ul>
          <li>a single <strong>coherence score</strong> from 0 to 1</li>
          <li>red line thresholds and default actions</li>
          <li>a tiny monitor you can ship in a day</li>
        </ul>
      </div>
    </div>
    <p class="note small">scope: this monitors bounded AI systems. it is not a claim about the world. this is an engineering control layer.</p>
  </section>

  <!-- Signals -->
  <section class="card" id="signals">
    <h2>signals</h2>
    <table class="table" role="table">
      <thead>
        <tr><th>name</th><th>how to compute</th><th>intuition</th></tr>
      </thead>
      <tbody>
        <tr>
          <td><strong>consistency</strong></td>
          <td>run k paraphrases of the prompt, embed outputs, compute mean pairwise cosine. scale to 0..1.</td>
          <td>stable models keep semantics under equivalent prompts.</td>
        </tr>
        <tr>
          <td><strong>robustness</strong></td>
          <td>apply tiny edits (char swap, stopword drop, truncation). measure output deltas in embedding space. invert and scale.</td>
          <td>micro perturbations should not flip meaning.</td>
        </tr>
        <tr>
          <td><strong>agreement</strong></td>
          <td>sample n responses via low temperature or n agents. compute majority overlap or average pairwise cosine.</td>
          <td>healthy ensembles do not scatter on simple items.</td>
        </tr>
        <tr>
          <td><strong>efficiency</strong></td>
          <td>tokens per second and latency vs answer quality proxy (e.g., exact match, score function, or length bound). normalize.</td>
          <td>waste heat rises when the model thrashes or loops.</td>
        </tr>
      </tbody>
    </table>
  </section>

  <!-- Coherence Score -->
  <section class="card" id="score">
    <h2>coherence score</h2>
    <p>combine signals with weights that you can tune per domain.</p>
    <pre><code>// default weights
w = { consistency: 0.35, robustness: 0.30, agreement: 0.25, efficiency: 0.10 }

// drift penalty: if robustness falls or latency spikes, apply a small penalty
penalty = Math.max(0, 0.15 - 0.15 * robustness) + Math.max(0, (latency_z &gt; 2) ? 0.05 : 0)

// final score
coherence = Math.max(0, Math.min(1,
  w.consistency*consistency +
  w.robustness*robustness +
  w.agreement*agreement +
  w.efficiency*efficiency - penalty
))</code></pre>
    <div class="cta">
      <button class="copy-btn" data-copy="#score code">copy</button>
    </div>
  </section>

  <!-- Thresholds -->
  <section class="card" id="thresholds">
    <h2>default thresholds</h2>
    <table class="table">
      <thead>
        <tr><th>state</th><th>rule</th><th>action</th></tr>
      </thead>
      <tbody>
        <tr class="ok">
          <td><strong>ok</strong></td>
          <td>coherence ≥ 0.65 and no single signal &lt; 0.40</td>
          <td>emit on fast path</td>
        </tr>
        <tr class="warn">
          <td><strong>warn</strong></td>
          <td>coherence in [0.45, 0.65) or any signal &lt; 0.40</td>
          <td>self query or fetch evidence, then re test</td>
        </tr>
        <tr class="stop">
          <td><strong>stop</strong></td>
          <td>coherence &lt; 0.45 or latency z score &gt; 2.5</td>
          <td>route to slow path or human review</td>
        </tr>
      </tbody>
    </table>
    <p class="small muted">calibrate with in domain validation. publish your 5th, 50th, and 95th percentiles.</p>
  </section>

  <!-- Quick start -->
  <section class="card" id="quickstart">
    <h2>quick start</h2>
    <ol>
      <li>generate k paraphrases and n samples per input</li>
      <li>compute signals and the coherence score</li>
      <li>gate risky outputs using the rules above</li>
    </ol>
    <div class="cta">
      <a class="btn" href="implementations.html">integration guides</a>
      <a class="btn" href="applications.html">use cases</a>
      <a class="btn" href="contact.html">start a pilot</a>
    </div>
  </section>

  <!-- Examples -->
  <section class="card" id="examples">
    <h2>examples</h2>
    <div class="grid two">
      <div class="card">
        <h3>python</h3>
<pre><code>from coherence_monitor import Monitor

monitor = Monitor(model=client, k=4, n=3)
score, signals = monitor(prompt="Summarize this article...", refs=docs)
if score &gt;= 0.65 and min(signals.values()) &gt;= 0.40:
    emit_fast(output=signals["best"])
elif score &gt;= 0.45:
    output = self_query(prompt, signals)
    review(output)
else:
    route_to_human(prompt, signals)</code></pre>
        <button class="copy-btn" data-copy="#examples pre code">copy</button>
      </div>
      <div class="card">
        <h3>node</h3>
<pre><code>import { Monitor } from "@cai/monitor"

const monitor = new Monitor({ k: 4, n: 3, provider })
const { score, signals, best } = await monitor.check("find issues in this PR")

if (score &gt;= 0.65 && Object.values(signals).every(v =&gt; v &gt;= 0.40)) {
  return best
}
if (score &gt;= 0.45) {
  const refined = await monitor.selfQuery("find issues in this PR", signals)
  return refined
}
return await monitor.routeToHuman({ prompt: "find issues in this PR", signals })</code></pre>
        <button class="copy-btn" data-copy="#examples .card:nth-of-type(2) pre code">copy</button>
      </div>
    </div>
  </section>

  <!-- Validation -->
  <section class="card" id="validation">
    <h2>validation</h2>
    <ul>
      <li>pick a task set. label stable vs unstable outcomes</li>
      <li>sweep k, n, and weights. freeze once AUC and false stop rate stabilize</li>
      <li>report percentiles for each signal by domain</li>
      <li>log signals to JSON for audits. replay on regressions</li>
    </ul>
    <p class="small muted">tip: most teams land near k=4 paraphrases and n=3 samples. start there.</p>
  </section>

  <!-- FAQ -->
  <section class="card" id="faq">
    <h2>faq</h2>
    <p><strong>do i need training access</strong><br>no. everything above works at inference.</p>
    <p><strong>what if outputs are non text</strong><br>embed captions or features. compare in the same way.</p>
    <p><strong>how heavy is this</strong><br>overhead is k×n forward passes. run on a canary path or batch.</p>
  </section>

  <section class="card" aria-live="polite">
    <p class="small muted">last updated <time id="last-updated"></time> • © <span id="year"></span> Compression-Aware Intelligence. terminology by Michele Joseph.</p>
  </section>
</main>

<footer class="site-footer">
  <div class="wrap">
    <small>all concepts and terminology by Michele Joseph.</small>
  </div>
</footer>

<script>
  // dates
  const y = document.getElementById('year'); if (y) y.textContent = new Date().getFullYear();
  const lu = document.getElementById('last-updated'); if (lu) lu.textContent = new Date().toISOString().slice(0,10);

  // copy helpers
  document.querySelectorAll('.copy-btn').forEach(btn=>{
    btn.addEventListener('click', ()=>{
      const target = document.querySelector(btn.getAttribute('data-copy'));
      if (!target) return;
      const text = target.innerText;
      navigator.clipboard.writeText(text).then(()=>{
        const old = btn.textContent;
        btn.textContent = 'copied';
        setTimeout(()=>btn.textContent = old, 1200);
      });
    });
  });
</script>
</body>
</html>
